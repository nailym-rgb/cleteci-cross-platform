version: 1
frontend:
  phases:
    # 1. Fase de Provisionamiento: Configura el entorno
    preBuild:
      commands:
        # Descarga e instala el SDK de Flutter
        - curl -sL https://raw.githubusercontent.com/aws-amplify/amplify-hosting/main/resources/amplify-build-setup/flutter-setup.sh | bash
        # Añade la variable de entorno FLUTTER_BIN a la PATH
        - export PATH="$PATH:$HOME/flutter/bin"
    # 2. Fase de Compilación: Compila el proyecto
    build:
      commands:
        # Obtiene las dependencias de pubspec.yaml
        - flutter pub get
        # Compila la aplicación web para producción
        - flutter build web --release
  # 3. Artefactos: Indica qué archivos subir al hosting
  artifacts:
    # El directorio donde 'flutter build web' guarda el resultado
    baseDirectory: build/web
    files:
      - '**/*'
  cache:
    paths: []